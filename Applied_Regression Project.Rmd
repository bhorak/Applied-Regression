---
title: "Applied Regression Course Project"
author: "Bohdan Horak"
date: "Friday, August 22, 2014"
output: pdf_document
---
```{r, echo=FALSE,include=FALSE}
transmission<-factor(mtcars$am,labels=c("Automatic","Manual"))
cylinders<-factor(mtcars$cyl,labels=c("4","6","8"))
vs<-factor(mtcars$vs,labels=c("0","1"))
gear<-factor(mtcars$gear,labels=c("3","4","5"))
carburetors<-factor(mtcars$carb,labels=c(1,2,3,4,6,8))
data<-mtcars
data$am<-transmission
data$cyl<-cylinders
data$vs<-vs
data$gear<-gear
data$carb<-carburetors
library(datasets); data(mtcars); library(stats); library(graphics)
library(gridExtra);
library(ggplot2);
```

## Executive Summary
The purpose of this paper is to examine the effects of a variety of car related features on the miles per gallon performance of a vehicle.
In order to convincingly illustrate the effects of factors on the car's gaes mileage a variety of statistical tools will be employed, using the
native "mtcars" data provided with R. This paper will examine all factors provided in the data set, however the focus will lie on the
type of transmission the car has equiped. There are two types of transmissions Manual and Automatic, this paper will exame which is better
or wether the differences between the two statistically insignificant given the provided data. 


## Exploratory Analysis 

### Data Description

The description of the variables, provided by the R help files.
```{r,echo=FALSE}
Variable<-colnames(data)
Description<-c("Miles/(US) gallon","Number of cylinders","Displacement (cu.in.)",
        "Gross horsepower","Rear axle ratio","Weight (lb/1000)","1/4 mile time",
        "V/S","Transmission (0 = automatic, 1 = manual)","Number of forward gears",
        "Number of carburetors")
desc<-data.frame(Variable,Description)
desc
```

In order to perform the exploratory analysis I split the variables into two camps, continous and discrete. 

```{r,echo=FALSE}
Discrete<-c("cyl","vs","am","gear","carb","")
Continous<-c("mpg","disp","hp","drat","wt","qsec")
vars<-data.frame(Continous,Discrete)
vars
```

For continous variables I used basic scatter plots with a fitted line to get a 
sense of the relationship. You can see the plots in figure 1. We can tell that as
the weight(wt), the displacement(disp) and Horsepower(hp) increase the mpg tends to 
decrease. The opposite is true for the Rear axle ratio(drat) and quarter mile time(qsec).

For discrete variable I used a series of bar plots(figure 2). The bar plots show the mean mpg for each variable seperated by factors. I also, included an error range which corresponds to a one deviation shift in the standard error of the mean. Please note, the carb variable has very few observation inclduded therefore any comparative anylysis between the factors is sure to be unreliable, so it will be ignored from now on. From looking ath these plots it seems like a higher

## Regressions

## Conclusion

## Appendix

### Figure 1: 

```{r Figure_1,echo=FALSE}


plot1<-qplot(wt,mpg,data=data)+geom_smooth(method = "lm")+ggtitle("MPG vs Weight")
plot2<-qplot(disp,mpg,data=data)+geom_smooth(method = "lm")+ggtitle("MPG vs Disp")
plot3<-qplot(hp,mpg,data=data)+geom_smooth(method = "lm")+ggtitle("MPG vs Horsepower")
plot4<-qplot(drat,mpg,data=data)+geom_smooth(method = "lm")+ggtitle("MPG vs Axle Ratio")
plot5<-qplot(qsec,mpg,data=data)+geom_smooth(method = "lm")+ggtitle("MPG vs Quarter Mile Time")
grid.arrange(plot1,plot2,plot3,plot4,plot5,ncol=3)
```





### Figure 2:
```{r, echo=FALSE,fig.height=6}
## define function
std<-function(x) sd(x)/sqrt(length(x))
inter<-function(x,y) {
    x$lower<-1:length(x$mpg)
    x$upper<-1:length(x$mpg)
    for (i in 1:length(x$mpg)) {
        x$lower[i]<-x$mpg[i]-y$mpg[i]
        x$upper[i]<-x$mpg[i]+y$mpg[i]
        
    }
    x
}

## data for plot 1
data_2<-aggregate(mpg~am,mean,data=data)
colnames(data_2)<-c("Transmission","mpg")
data_3<-aggregate(mpg~am,std,data=data)
data_2<-inter(data_2,data_3)

## barplot 1
barplot1 <- qplot(x=Transmission, y=mpg, fill=Transmission,data=data_2, geom="bar", stat="identity",position="dodge")
barplot1<- barplot1 + geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9),data=data_2) + 
    ggtitle("Average MPG by Transmission") + guides(fill=FALSE)

## data for plot 2
data_2<-aggregate(mpg~cyl,mean,data=data)
colnames(data_2)<-c("Cylinders","mpg")
data_3<-aggregate(mpg~cyl,std,data=data)
data_2<-inter(data_2,data_3)

## barplot 2
barplot2 <- qplot(x=Cylinders, y=mpg, fill=Cylinders,data=data_2, geom="bar", stat="identity",position="dodge")
barplot2<- barplot2 + geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9),data=data_2) + 
    ggtitle("Average MPG by Cylinders") + guides(fill=FALSE)


## data for plot 3
data_2<-aggregate(mpg~vs,mean,data=data)
colnames(data_2)<-c("VS","mpg")
data_3<-aggregate(mpg~vs,std,data=data)
data_2<-inter(data_2,data_3)

## barplot 3
barplot3 <- qplot(x=VS, y=mpg, fill=VS,data=data_2, geom="bar", stat="identity",position="dodge")
barplot3<- barplot3 + geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9),data=data_2) + 
    ggtitle("Average MPG by VS") + guides(fill=FALSE)

## data for barplot 4
data_2<-aggregate(mpg~gear,mean,data=data)
colnames(data_2)<-c("Gears","mpg")
data_3<-aggregate(mpg~gear,std,data=data)
data_2<-inter(data_2,data_3)

## barplot 4
barplot4 <- qplot(x=Gears, y=mpg, fill=Gears,data=data_2, geom="bar", stat="identity",position="dodge")
barplot4<- barplot4 + geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9),data=data_2) + 
    ggtitle("Average MPG by Gears") + guides(fill=FALSE)


## data for barplot 4
data_2<-aggregate(mpg~gear,mean,data=data)
colnames(data_2)<-c("Gears","mpg")
data_3<-aggregate(mpg~gear,std,data=data)
data_2<-inter(data_2,data_3)

## barplot 4
barplot4 <- qplot(x=Gears, y=mpg, fill=Gears,data=data_2, geom="bar", stat="identity",position="dodge")
barplot4<- barplot4 + geom_errorbar(aes(ymax=upper, ymin=lower), position=position_dodge(0.9),data=data_2) + 
    ggtitle("Average MPG by Gears") + guides(fill=FALSE)
grid.arrange(barplot1,barplot2,barplot3,barplot4,ncol=2)

```


### Figure 3:










